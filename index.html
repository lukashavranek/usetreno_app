
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>U≈°et≈ôeno za zlozvyky</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding: 20px; }
    .progress-bar { font-weight: bold; }
    #previewImage {
      max-width: 100%;
      max-height: 200px;
      object-fit: contain;
      margin-bottom: 20px;
      display: none;
    }
  </style>
</head>
<body class="bg-light text-dark">

  <div class="container">
    <h1 class="mt-3 mb-4">üéØ U≈°et≈ôeno za zlozvyky</h1>

    <div id="formSection">
      <div class="mb-3">
        <label class="form-label">Co si chce≈° koupit?</label>
        <input type="text" class="form-control" id="goalItem" placeholder="Nap≈ô. Sluch√°tka">
      </div>

      <div class="mb-3">
        <label class="form-label">Cena c√≠le (Kƒç)</label>
        <input type="number" class="form-control" id="goalAmount" placeholder="Nap≈ô. 2500">
      </div>

      <div class="mb-3">
        <label class="form-label">Zlozvyk (nap≈ô. kafe)</label>
        <input type="text" class="form-control" id="unitName" placeholder="Nap≈ô. kafe">
      </div>

      <div class="mb-3">
        <label class="form-label">Cena jednoho zlozvyku (Kƒç)</label>
        <input type="number" class="form-control" id="unitValue" placeholder="Nap≈ô. 50">
      </div>

      <div class="mb-3">
        <label class="form-label">URL obr√°zku (nepovinn√©)</label>
        <input type="url" class="form-control" id="imageUrl" placeholder="https://...">
      </div>

      <button class="btn btn-primary mb-4" onclick="startTracker()">Zaƒç√≠t sledovat</button>
    </div>

    <div id="tracker" style="display:none;">
      <img id="previewImage" src="" alt="P≈ôedmƒõt">
      <h3><span id="goalText"></span></h3>

      <div class="progress mb-3">
        <div class="progress-bar" id="progressBar" style="width: 0%">0%</div>
      </div>

      <p class="lead">üí∞ U≈°et≈ôeno: <strong><span id="saved">0</span> Kƒç</strong></p>
      <p class="lead">üìâ Zb√Ωv√°: <strong><span id="remaining"></span> Kƒç</strong></p>
      <p class="lead">üßæ Poƒçet nevyu≈æit√Ωch <span id="unitLabel"></span>: <strong><span id="count">0</span></strong></p>

      <button class="btn btn-success mb-3" onclick="increment()">+1 nevyu≈æit√© <span id="unitLabelBtn"></span></button>
      <button class="btn btn-outline-danger mb-3" onclick="resetTracker()">üîÅ Reset</button>
      <p id="message" class="fw-bold text-success"></p>
    </div>
  </div>

  <script>
    let goal = 0, unit = 0, saved = 0, count = 0;
    let unitName = '', goalName = '', imageUrl = '';

    function startTracker() {
      goalName = document.getElementById("goalItem").value;
      goal = parseFloat(document.getElementById("goalAmount").value);
      unitName = document.getElementById("unitName").value;
      unit = parseFloat(document.getElementById("unitValue").value);
      imageUrl = document.getElementById("imageUrl").value;

      if (!goalName || isNaN(goal) || !unitName || isNaN(unit)) {
        alert("Pros√≠m vypl≈à v≈°echna pole spr√°vnƒõ.");
        return;
      }

      saved = 0;
      count = 0;

      updateUI();
      saveToLocal();
      document.getElementById("formSection").style.display = "none";
    }

    function increment() {
      saved += unit;
      count += 1;
      updateUI();
      saveToLocal();

      if (saved >= goal) {
        document.getElementById("message").textContent = "üéâ C√≠l splnƒõn! M≈Ø≈æe≈° si to koupit!";
      }
    }

    function updateUI() {
      const percent = Math.min(100, (saved / goal) * 100).toFixed(0);
      document.getElementById("goalText").textContent = `${goalName} za ${goal} Kƒç`;
      document.getElementById("unitLabel").textContent = unitName;
      document.getElementById("unitLabelBtn").textContent = unitName;
      document.getElementById("saved").textContent = saved.toFixed(0);
      document.getElementById("remaining").textContent = Math.max(0, (goal - saved).toFixed(0));
      document.getElementById("count").textContent = count;

      const progressBar = document.getElementById("progressBar");
      progressBar.style.width = percent + "%";
      progressBar.textContent = percent + "%";

      const img = document.getElementById("previewImage");
      if (imageUrl) {
        img.src = imageUrl;
        img.style.display = "block";
      } else {
        img.style.display = "none";
      }

      document.getElementById("message").textContent = "";
      document.getElementById("tracker").style.display = "block";
    }

    function saveToLocal() {
      const data = {
        goalName, goal, unitName, unit, saved, count, imageUrl
      };
      localStorage.setItem("savingsTracker", JSON.stringify(data));
    }

    function resetTracker() {
      localStorage.removeItem("savingsTracker");
      location.reload();
    }

    function loadFromLocal() {
      const data = JSON.parse(localStorage.getItem("savingsTracker"));
      if (data) {
        goalName = data.goalName;
        goal = data.goal;
        unitName = data.unitName;
        unit = data.unit;
        saved = data.saved;
        count = data.count;
        imageUrl = data.imageUrl;
        updateUI();
        document.getElementById("formSection").style.display = "none";
      }
    }

    window.onload = loadFromLocal;
  </script>

</body>
</html>
